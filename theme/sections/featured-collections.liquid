{% comment %}
  Featured Collections Section - Converted from Home.tsx categories section
{% endcomment %}

<section class="categories">
  <div class="section-header">
    <h2>{{ section.settings.heading }}</h2>
  </div>
  <div class="categories-grid">
    {% if section.blocks.size > 0 %}
      {% for block in section.blocks %}
        {% assign collection = collections[block.settings.collection] %}
        {% if collection %}
          <a href="{{ collection.url }}" class="category-card" {{ block.shopify_attributes }}>
            {% if block.settings.image != blank %}
              <img src="{{ block.settings.image | img_url: 'medium' }}" alt="{{ block.settings.title }}" loading="lazy" />
            {% elsif collection.image %}
              <img src="{{ collection.image | img_url: 'medium' }}" alt="{{ collection.title }}" loading="lazy" />
            {% endif %}
            <span class="category-name">{{ block.settings.title | default: collection.title }}</span>
          </a>
        {% endif %}
      {% endfor %}
    {% else %}
      {% comment %} Default collections if no blocks are set {% endcomment %}
      {% for collection in collections limit: 5 %}
        {% if collection.image %}
          <a href="{{ collection.url }}" class="category-card">
            <img src="{{ collection.image | img_url: 'medium' }}" alt="{{ collection.title }}" loading="lazy" />
            <span class="category-name">{{ collection.title }}</span>
          </a>
        {% endif %}
      {% endfor %}
    {% endif %}
  </div>
</section>

<style>
.categories {
  max-width: 100%;
  margin: 0 auto;
  padding: 4rem 3rem;
}

.categories-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
}

.category-card {
  position: relative;
  aspect-ratio: 3 / 4;
  overflow: hidden;
  text-decoration: none;
}

.category-card img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.category-name {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  padding: 1rem;
  background: rgba(0, 0, 0, 0.8);
  color: white;
  font-size: 0.875rem;
  font-weight: 700;
  letter-spacing: 0;
  text-transform: uppercase;
  text-align: center;
}

@media (max-width: 1024px) {
  .categories-grid {
    grid-template-columns: repeat(3, 1fr);
  }
}

@media (max-width: 640px) {
  .categories {
    padding: 3rem 1rem;
  }

  .categories-grid {
    grid-template-columns: repeat(2, 1fr);
    gap: 0.5rem;
  }
}
</style>

{% schema %}
{
  "name": "Featured Collections",
  "tag": "section",
  "class": "categories",
  "settings": [
    {
      "type": "header",
      "content": "Section Content"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Shop by Category"
    },
    {
      "type": "checkbox",
      "id": "show_heading",
      "label": "Show Heading",
      "default": true
    },
    {
      "type": "header",
      "content": "Layout"
    },
    {
      "type": "range",
      "id": "collections_per_row",
      "min": 2,
      "max": 6,
      "step": 1,
      "label": "Collections Per Row",
      "default": 5,
      "info": "Number of collections displayed per row on desktop"
    },
    {
      "type": "range",
      "id": "section_padding_top",
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "px",
      "label": "Section Padding Top",
      "default": 60
    },
    {
      "type": "range",
      "id": "section_padding_bottom",
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "px",
      "label": "Section Padding Bottom",
      "default": 60
    },
    {
      "type": "header",
      "content": "Styling"
    },
    {
      "type": "checkbox",
      "id": "show_overlay",
      "label": "Show Dark Overlay on Images",
      "default": true,
      "info": "Dark overlay behind collection name for better readability"
    }
  ],
  "blocks": [
    {
      "type": "collection",
      "name": "Collection",
      "limit": 12,
      "settings": [
        {
          "type": "collection",
          "id": "collection",
          "label": "Collection"
        },
        {
          "type": "text",
          "id": "title",
          "label": "Title Override",
          "info": "Leave empty to use collection title"
        },
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image Override",
          "info": "Leave empty to use collection featured image"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Featured Collections",
      "settings": {
        "heading": "Shop by Category",
        "show_heading": true,
        "collections_per_row": 5
      }
    }
  ]
}
{% endschema %}
